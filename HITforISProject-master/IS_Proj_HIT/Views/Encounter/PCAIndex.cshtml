@model IS_Proj_HIT.ViewModels.ViewEncounterPageModel


<partial name="PatientBannerPartial" model="Model.Patient" />
<partial name="_EncounterMenu"/>
<div class="container">

    <div class="row justify-content-start">
        <div class="col mx-0 px-0">
            <h3 class="error">@ViewData["ErrorMessage"]</h3>
            @if (!User.IsInRole("Registrar"))
            {
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h4>
                            Patient Care Assessments
                            @if (User.IsInRole("Administrator") || User.IsInRole("Nursing Faculty") || User.IsInRole("HIT Faculty") || User.IsInRole("Nursing Student"))
                            {
                                <a asp-controller="PCA"
                                asp-action="CreateAssessment"
                                asp-route-encounterId="@Model.Encounter.EncounterId"
                                asp-route-mrn="@Model.Patient.Mrn"
                                class="btn btn-info btn-sm float-right">
                                    Create New PCA
                                </a>
                            }
                        </h4>
                    </div>
                    <div class="card-body bg-light">
                        <div class="container">
                            <table class="table table-bordered table-primary">
                                <thead>
                                    <tr>
                                        <th>View</th>
                                        <th>Date Vitals Entered</th>
                                        <th>Temperature</th>
                                        <th>Respiration</th>
                                        <th>Blood Pressure</th>
                                        <th class="d-sm-none d-lg-table-cell">Pulse</th>
                                        <th class="d-sm-none d-lg-table-cell">Pulse Oximetry</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @{
                                        var counter = 0;
                                    }
                                    @foreach (var pca in Model.Encounter.Pcarecords.OrderByDescending(pca => pca.DateVitalsAdded))
                                    {
                                        <tr @(counter++ < 5 ? string.Empty : "class=extra-row")>
                                            <td>
                                                <a asp-controller="PCA"
                                                asp-action="ViewAssessment"
                                                asp-route-assessmentId="@pca.Pcaid"
                                                class="btn btn-info btn-sm">
                                                    View
                                                </a>
                                            </td>
                                            <td>@pca.DateVitalsAdded</td>
                                            <td>@(pca.Temperature?.ToString() ?? "N/A") *F</td>
                                            <td>@pca.Respiration /min</td>
                                            <td>@pca.SystolicBloodPressure / @pca.DiastolicBloodPressure</td>
                                            <td class="d-sm-none d-lg-table-cell">@pca.Pulse /min</td>
                                            <td class="d-sm-none d-lg-table-cell">@pca.PulseOximetry%</td>
                                        </tr>
                                    }
                                    @if (Model.Encounter.Pcarecords.Count > 5)
                                    {
                                        <tr>
                                            <td colspan="99">
                                                <button class="btn btn-block btn-info" id="hide-row-btn">
                                                    Show More
                                                </button>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
             }


            <hr />

        
            <a asp-action="CheckedIn"
            class="btn btn-outline-primary m-l-1">
                View <b>Checked In</b> Encounters
            </a>

        </div>
    </div>
</div>
